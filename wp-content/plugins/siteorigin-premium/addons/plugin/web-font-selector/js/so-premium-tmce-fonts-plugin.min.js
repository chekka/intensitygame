var SOPremiumFontSelectorPlugin=function(t,o=null){var n,e=jQuery,i="so_premium_font_format",r=soPremiumFonts.font_modules;function a(){new SOPremiumFontsImporter(t.contentDocument).importFonts()}function m(){n.attr("data-placeholder",soPremiumFonts.placeholder_text),n.webfontselector({modules:r,useVariants:!0,useSubsets:!1,showInherit:!1});var o=n.siblings(".chosen-container");o.addClass("mce-so-premium-font-selector");var e,a=o.find(".chosen-search input");a.on("mouseup",(function(){e||(e=setTimeout((function(){a.trigger("focus"),e=null}),100))})),n.on("font_change",(function(o,n,e){n&&n.hasOwnProperty("font")&&n.font?t.execCommand("soPremiumApplyFont",i,n):t.execCommand("soPremiumRemoveFont",i)}))}t.on("init",(function(){t.formatter.register(i,{inline:"span",classes:"so-premium-web-font",attributes:{"data-web-font-module":"%fontModule","data-font-info":"%fontInfo"},styles:{"font-family":"%fontFamily","font-weight":"%fontWeight"},remove:"all"}),a()})),t.on("NodeChange",(function(o){if(t.formatter&&n){var e=o.element,i="",r="";if(e.hasAttribute("data-font-info")){var a=JSON.parse(e.getAttribute("data-font-info"));i=a.font,r=a.hasOwnProperty("variant")?a.variant:""}n.webfontselector("update",i,r)}})),t.addCommand("soPremiumApplyFont",(function(o,n){var e=n.font?"'"+n.font+"'":"";e+=n.category?", "+n.category:"";var i="regular";if(n.variant){var r=n.variant.match(/(\d*)(\w*)/);r.length>1&&r[1]&&(i=r[1])}t.formatter.apply(o,{fontFamily:e,fontWeight:i,fontInfo:JSON.stringify(n),fontModule:n.module}),a()})),t.addCommand("soPremiumRemoveFont",(function(o){t.formatter.remove(o,{fontFamily:null,fontModule:null},null,!0)})),t.addButton("so-premium-font-selector",{type:"selectbox",icon:!1,onPostRender:function(t){if((n=e(t.control.$el)).is(":visible"))m();else var o=setInterval((function(){n.is(":visible")&&(m(),clearInterval(o),o=null)}),500)}})};(0,window.jQuery)(document).on("load tinymce-editor-setup",(function(t,o){window.tinymce&&(void 0===o.settings.external_plugins["so-premium-font-selector"]?(-1==o.settings.toolbar1.indexOf("so-premium")&&(o.settings.toolbar1+=",so-premium-font-selector"),new SOPremiumFontSelectorPlugin(o)):window.tinymce.PluginManager.add("so-premium-font-selector",(function(t,o){new SOPremiumFontSelectorPlugin(t,o)})))}));